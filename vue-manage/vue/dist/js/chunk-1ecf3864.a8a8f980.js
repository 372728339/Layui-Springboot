(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1ecf3864"],{1521:function(e,t,s){},4994:function(e,t,s){"use strict";var r=s("1521"),a=s.n(r);a.a},"4fde":function(e,t,s){"use strict";var r=s("7ce0"),a=s.n(r);a.a},"5c67":function(e,t,s){},"5ced":function(e,t,s){},"6dc5":function(e,t,s){"use strict";var r=s("5c67"),a=s.n(r);a.a},"7ce0":function(e,t,s){},bb51:function(e,t,s){"use strict";s.r(t);var r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticStyle:{position:"relative","margin-left":"10px","margin-right":"10px"}},[s("Login"),e.$store.state.login.loginStatus?s("Tabs",{attrs:{type:"card"}},[s("TabPane",{attrs:{label:"首页"}},[s("Center")],1),s("TabPane",{attrs:{label:"后台操作"}},[s("Resource")],1),e.$store.state.login.isGm?s("TabPane",{attrs:{label:"管理员"}},[e.$store.state.login.isGm?s("Manger"):e._e()],1):e._e(),e.$store.state.login.isAdmin?s("TabPane",{attrs:{label:"网站管理"}},[e.$store.state.login.isAdmin?s("Admin"):e._e()],1):e._e()],1):e._e(),e.$store.state.loading?s("Spin",{attrs:{fix:""}}):e._e()],1)},a=[],i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticStyle:{"text-align":"center"}},[s("Icon",{attrs:{type:"ios-home",size:"50",color:"rgb(135, 208, 104)"}}),s("h2",[e._v("昵称："),s("span",[e._v(e._s(e.$store.getters.getUserInfo.roleName))])]),s("h2",[e._v("等级："),s("span",[e._v(e._s(e.$store.getters.getUserInfo.privilege))])]),e.$store.getters.getPrivilege("resetPassword")?s("div",{staticStyle:{"margin-top":"20px"}},[s("Button",{attrs:{type:"primary",long:""},on:{click:e.resetPwd}},[e._v("修改密码")])],1):e._e(),e.$store.getters.getPrivilege("addPrivilege")?s("div",[s("Form",{ref:"formCode",attrs:{"label-position":"left",model:e.formCode,rules:e.ruleCode}},[s("FormItem",{attrs:{prop:"code"}},[s("Input",{staticStyle:{"margin-top":"20px"},attrs:{placeholder:"激活码...",type:"text"},model:{value:e.formCode.code,callback:function(t){e.$set(e.formCode,"code",t)},expression:"formCode.code"}})],1)],1),s("div",{staticStyle:{"margin-top":"20px"}},[s("Button",{attrs:{type:"primary",long:""},on:{click:function(t){return e.level("formCode")}}},[e._v("提升权限")])],1)],1):e._e(),s("div",{staticStyle:{"margin-top":"20px"}},[s("Button",{attrs:{type:"primary",long:""},on:{click:e.logout}},[e._v("退出登录")])],1)],1)},o=[],l=s("1bab"),n={name:"Center",data(){return{username:"",roleName:"",privilege:"",formCode:{code:""},ruleCode:{code:[{required:!0,message:"请输入32位激活码",trigger:"blur"},{min:32,message:"请输入32位激活码",trigger:"blur"}]}}},methods:{level(e){this.$refs[e].validate(e=>{e&&Object(l["a"])({url:"/user/addPrivilege",params:{code:this.formCode.code}},this).then(e=>{0===e.data.resultCode?(this.$Message.success(e.data.rtnMessage),localStorage.setItem("privilege",e.data.data.privilege),this.$store.commit("updateInfo",{privilege:localStorage.getItem("privilege")})):this.$Message.error(e.data.rtnMessage),this.$Spin.hide()}).catch(e=>{console.log(e),this.$Message.error("发生错误，请联系管理员")})})},logout(){this.$Modal.confirm({title:"退出登录",content:"<p>确认退出登录吗？</p>",onOk:()=>{Object(l["a"])({url:"/user/logout"},this).then(e=>{0===e.data.resultCode?(localStorage.clear(),this.$store.commit("updateInfo",{username:null,roleName:null,privilege:null}),this.$store.commit("logout"),this.$store.commit("showLoginBox"),this.$store.commit("clearItem")):this.$Message.error(e.data.rtnMessage),this.$Spin.hide()}).catch(e=>{console.log(e),this.$Message.error("发生错误，请联系管理员")})},onCancel:()=>{}})},resetPwd(){this.$store.commit("changeTab","reset"),this.$store.commit("showLoginBox")}}},m=n,c=s("2877"),d=Object(c["a"])(m,i,o,!1,null,null,null),g=d.exports,u=function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.$store.getters.getPrivilege("mail")?s("div",[s("ItemTable",{attrs:{isAdmin:e.isAdmin},on:{postBan:e.postBan}}),s("PostItem",{ref:"postItem",attrs:{itemInfo:e.activeItem}})],1):e._e()},p=[],h=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("Form",{ref:"formPost",attrs:{rules:e.rulePost,model:e.formPost}},[s("FormItem",{attrs:{prop:"num"}},[s("Row",{attrs:{gutter:16}},[s("Col",{attrs:{span:"12"}},[s("Input",{attrs:{placeholder:"请输入物品数量...",type:"number"},model:{value:e.formPost.num,callback:function(t){e.$set(e.formPost,"num",t)},expression:"formPost.num"}})],1),s("Col",{attrs:{span:"12"}},[s("Button",{attrs:{long:"",type:"primary",disabled:e.disabled},on:{click:function(t){return e.post("formPost")}}},[e._v("发送物品")])],1)],1)],1)],1)},v=[],f={name:"PostItem",data(){const e=(e,t,s)=>{""===t?s(new Error("数量不能为空")):t>999?s(new Error("数量不能大于999")):t<=0?s(new Error("请输入正确的数量")):s()};return{formPost:{num:""},disabled:!0,rulePost:{num:[{validator:e,trigger:"blur"}]}}},methods:{post(e){this.$refs[e].validate(e=>{e&&(this.itemInfo.isGm?Object(l["a"])({url:"/gm/mail",params:{uname:this.itemInfo.username,itemId:this.itemInfo.itemInfo.id,num:this.formPost.num}},this).then(e=>{const t=e.data;0===t.resultCode?this.$Message.success(t.rtnMessage):this.$Message.error(t.rtnMessage),this.$Spin.hide()}).catch(e=>{console.log(e),this.$Message.error("发生错误，请联系管理员")}):(console.log(1),Object(l["a"])({url:"/gm/mail",params:{uname:this.$store.state.user.username,itemId:this.itemInfo.itemInfo.id,num:this.formPost.num}},this).then(e=>{const t=e.data;0===t.resultCode?this.$Message.success(t.rtnMessage):this.$Message.error(t.rtnMessage),this.$Spin.hide()}).catch(e=>{console.log(e),this.$Message.error("发生错误，请联系管理员")})))})}},props:["itemInfo"]},b=f,$=Object(c["a"])(b,h,v,!1,null,"22cd9ce1",null),I=$.exports,y=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("Row",{attrs:{gutter:16}},[s("Col",{attrs:{span:"12"}},[s("Input",{attrs:{placeholder:"请输入物品名称...",type:"text"},model:{value:e.itemSearch,callback:function(t){e.itemSearch=t},expression:"itemSearch"}})],1),s("Col",{attrs:{span:"12"}},[s("Button",{attrs:{type:"primary",long:""}},[e._v("搜索")])],1)],1),s("br"),s("Table",{ref:"itemTable",attrs:{size:"small",loading:e.tableLoading,border:"","highlight-row":"",columns:e.item,data:e.itemList},on:{"on-current-change":e.selection}}),s("div",{staticStyle:{margin:"10px",overflow:"hidden"}},[s("div",{staticStyle:{float:"right"}},[s("Page",{attrs:{total:e.$store.state.item.total,current:1,size:"small","show-total":""},on:{"on-change":e.changePage}})],1)])],1)},S=[],w={name:"ItemTable",data(){return{itemSearch:"",tableLoading:!1,item:this.itemHeader(),itemList:this.$store.state.item.itemInfo}},methods:{itemHeader(){let e=[];return this.isAdmin?e.push({title:"物品ID",key:"id",align:"center"},{title:"物品名称",key:"name",align:"center"},{title:"物品类别",key:"type",align:"center"},{title:"物品权限",key:"privilege",align:"center"}):e.push({title:"物品名称",key:"name",align:"center"},{title:"物品类别",key:"type",align:"center"}),e},changePage(e){Object(l["a"])({url:"/user/itemList",params:{page:e}},this).then(e=>{const t=e.data;1===t.resultCode&&this.$store.commit("updateItem",t.table),this.$Spin.hide()}).catch(e=>{console.log(e),this.$Message.error("发生错误，请联系管理员")})},selection(e,t){this.$emit("postBan",e)}},props:["isAdmin"]},x=w,C=Object(c["a"])(x,y,S,!1,null,"2106f6ec",null),_=C.exports,M={name:"Resource",data(){return{isAdmin:!1,activeItem:""}},methods:{postBan(e){this.activeItem={itemInfo:e,username:localStorage.getItem("username"),isGm:!1},this.$refs.postItem.disabled=!1}},components:{ItemTable:_,PostItem:I}},P=M,k=Object(c["a"])(P,u,p,!1,null,"41835818",null),R=k.exports,F=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("Row",{attrs:{gutter:16}},[s("Col",{attrs:{span:"12"}},[s("Input",{attrs:{placeholder:"请输入昵称...",type:"text"},model:{value:e.roleName,callback:function(t){e.roleName=t},expression:"roleName"}})],1),s("Col",{attrs:{span:"12"}},[s("Input",{attrs:{readonly:"",type:"text"},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}})],1)],1),s("br"),s("Row",{attrs:{gutter:16}},[s("Col",{attrs:{span:"12"}},[s("Button",{attrs:{long:"",type:"primary"},on:{click:e.searchUname}},[e._v("查询账号")])],1),e.$store.getters.getPrivilege("gmCloseAccount")?s("Col",{attrs:{span:"12"}},[s("Button",{attrs:{long:"",type:"primary",disabled:e.ban}},[e._v("封禁用户")])],1):e._e()],1),s("br"),e.$store.getters.getPrivilege("gmMail")?s("ItemTable",{attrs:{isAdmin:e.isAdmin},on:{postBan:e.postBan}}):e._e(),e.$store.getters.getPrivilege("gmMail")?s("PostItem",{ref:"postItem",attrs:{itemInfo:e.activeItem}}):e._e(),s("CodeTable")],1)},B=[],T=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("Form",[s("Table",{ref:"itemTable",attrs:{size:"small",loading:e.tableLoading,border:"","highlight-row":"",columns:e.code,data:e.codeList},on:{"on-current-change":e.selection}}),s("div",{staticStyle:{margin:"10px",overflow:"hidden"}},[s("div",{staticStyle:{float:"right"}},[s("Page",{attrs:{total:e.$store.state.total,current:1,size:"small","show-total":""},on:{"on-change":e.changePage}})],1)]),s("FormItem",[e.$store.getters.getPrivilege("gmDeleteRegCode")?s("Button",{staticStyle:{width:"100%"},attrs:{type:"primary",disabled:e.disabled},on:{click:e.deleteCode}},[e._v("删除激活码 ")]):e._e()],1),e.$store.getters.getPrivilege("gmInsertRegCode")?s("Slider",{staticStyle:{"margin-left":"10px"},attrs:{min:1,max:e.$store.state.user.privilege-1,step:1,"show-input":""},model:{value:e.privilege,callback:function(t){e.privilege=t},expression:"privilege"}}):e._e(),e.$store.getters.getPrivilege("gmInsertRegCode")?s("Button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:e.productCode}},[e._v("生成激活码 ")]):e._e()],1)],1)},O=[],j={name:"CodeTable",data(){return{privilege:1,tableLoading:!1,disabled:!0,code:[{title:"激活码",key:"code",align:"center"},{title:"权限",key:"privilege",align:"center",width:"80",sortable:!0}],codeList:this.$store.state.codeInfo,selectCode:{}}},methods:{changePage(e){Object(l["a"])({url:"/gm/findRegCodeList",params:{page:e}},this).then(e=>{const t=e.data;1===t.resultCode?(this.$store.commit("updateCode",t.table),this.$store.commit("codeTotal",t.total)):this.$Message.error(t.rtnMessage),this.$Spin.hide()}).catch(e=>{console.log(e),this.$Message.error("发生错误，请联系管理员")})},selection(e,t){this.disabled=!1,this.selectCode=e},productCode(){Object(l["a"])({url:"/gm/insertRegCode",params:{privilege:this.privilege}},this).then(e=>{const t=e.data;0===t.resultCode?(this.$Message.success(t.rtnMessage),this.$store.dispatch("getCode",this)):this.$Message.error(t.rtnMessage),this.$Spin.hide()}).catch(e=>{console.log(e),this.$Message.error("发生错误，请联系管理员")})},deleteCode(){Object(l["a"])({url:"/gm/deleteRegCode",params:{code:this.selectCode.code}},this).then(e=>{const t=e.data;0===t.resultCode?(this.$Message.success(t.rtnMessage),this.$store.dispatch("getCode",this)):this.$Message.error(t.rtnMessage),this.$Spin.hide()}).catch(e=>{console.log(e),this.$Message.error("发生错误，请联系管理员")})}}},L=j,N=Object(c["a"])(L,T,O,!1,null,"7a718796",null),A=N.exports,E={name:"Manger",data(){return{ban:!0,username:"",disabled:!0,isAdmin:!1,roleName:"",activeItem:""}},methods:{postBan(e){""!=this.username?this.activeItem={itemInfo:e,username:this.username,isGm:!0}:this.activeItem={itemInfo:e,username:localStorage.getItem("username"),isGm:!1},this.$refs.postItem.disabled=!1},searchUname(){Object(l["a"])({url:"/gm/getUname",params:{roleName:this.roleName}},this).then(e=>{const t=e.data;0===t.resultCode?(this.username=t.rtnMessage,this.ban=!1):this.$Message.error(t.rtnMessage),this.$Spin.hide()}).catch(e=>{console.log(e),this.$Message.error("发生错误，请联系管理员")})}},components:{ItemTable:_,CodeTable:A,PostItem:I}},G=E,U=Object(c["a"])(G,F,B,!1,null,"505bed66",null),q=U.exports,z=function(){var e=this,t=this,s=t.$createElement,r=t._self._c||s;return r("Form",[r("h5",{staticStyle:{"text-align":"center"}},[t._v("用户权限管理")]),r("FormItem",{attrs:{label:"选择功能：","label-width":80}},[r("Select",{staticStyle:{display:"inline-block"},attrs:{"label-in-value":!0},on:{"on-change":t.changeUserPrivilege},model:{value:t.userFn,callback:function(e){t.userFn=e},expression:"userFn"}},t._l(t.userFnList,(function(e){return r("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])})),1)],1),r("FormItem",{attrs:{label:"设置权限：","label-width":80}},[r("Slider",{staticStyle:{"margin-left":"10px"},attrs:{disabled:t.userSlider,max:10,min:1,step:1,"show-input":""},model:{value:t.setUserPrivilege,callback:function(e){t.setUserPrivilege=e},expression:"setUserPrivilege"}}),r("Button",{attrs:{type:"primary",long:""},on:{click:t.setUser}},[t._v("修改用户权限")])],1),r("hr"),r("h5",{staticStyle:{"text-align":"center"}},[t._v("管理员权限管理")]),r("FormItem",{attrs:{label:"选择功能：","label-width":80}},[r("Select",{staticStyle:{display:"inline-block"},attrs:{"label-in-value":!0},on:{"on-change":t.changeGmPrivilege},model:{value:t.gmFn,callback:function(e){t.gmFn=e},expression:"gmFn"}},t._l(t.gmFnList,(function(e){return r("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])})),1)],1),r("FormItem",{attrs:{label:"设置权限：","label-width":80}},[r("Slider",{staticStyle:{"margin-left":"10px"},attrs:{disabled:t.gmSlider,max:10,min:1,step:1,"show-input":""},model:{value:t.setGmPrivilege,callback:function(e){t.setGmPrivilege=e},expression:"setGmPrivilege"}}),r("Button",{attrs:{type:"primary",long:""},on:{click:t.setGm}},[t._v("修改管理员权限")])],1),r("hr"),r("h5",{staticStyle:{"text-align":"center"}},[t._v("物品管理")]),r("ItemTable",{attrs:{isAdmin:t.isAdmin},on:{postBan:t.postBan}}),r("Row",{attrs:{gutter:16}},[r("Col",{attrs:{span:"6"}},[r("Button",{attrs:{type:"primary",long:""},on:{click:t.addItem}},[t._v("新增物品")])],1),r("Col",{attrs:{span:"6"}},[r("Button",{attrs:{type:"primary",disabled:t.disabled,long:""}},[t._v("修改物品")])],1),r("Col",{attrs:{span:"6"}},[r("Button",{attrs:{type:"primary",disabled:t.disabled,long:""},on:{click:t.deleteItem}},[t._v("删除物品")])],1),r("Col",{attrs:{span:"6"}},[r("Button",{attrs:{type:"primary",long:""},on:{click:t.exportItem}},[t._v("excel导出")])],1)],1),r("Row",{staticStyle:{"margin-left":"-5px","margin-right":"-5px","margin-top":"10px"}},[r("Col",[r("Upload",{attrs:{format:["xls"],"on-format-error":function(){return e.$Message.error("传入文件类型不是xls")},"show-upload-list":!1,multiple:"",type:"drag","on-success":t.uploadItem,action:"http://127.0.0.1/gm/import"}},[r("div",{staticStyle:{padding:"20px 0"}},[r("Icon",{staticStyle:{color:"#3399ff"},attrs:{type:"ios-cloud-upload",size:"52"}}),r("p",[t._v("excel导入")])],1)])],1)],1),r("hr"),r("h5",{staticStyle:{"text-align":"center"}},[t._v("激活码管理")]),r("CodeTable"),r("ChangeItem",{ref:"itemBox"})],1)},D=[],H=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("Modal",{model:{value:e.model,callback:function(t){e.model=t},expression:"model"}},[s("p",{staticStyle:{"font-weight":"800"},attrs:{slot:"header"},slot:"header"},[s("span",[e._v("新增物品")])]),s("Form",{ref:"item",attrs:{"label-position":"left",model:e.item,rules:e.ruleItem,"label-width":80}},[s("FormItem",{staticStyle:{"font-size":"12px"},attrs:{label:"物品ID",prop:"id"}},[s("Input",{attrs:{placeholder:"请输入物品ID...",type:"text"},model:{value:e.item.id,callback:function(t){e.$set(e.item,"id",t)},expression:"item.id"}})],1),s("FormItem",{attrs:{label:"物品名称",prop:"name"}},[s("Input",{attrs:{placeholder:"请输入物品名称...",type:"text"},on:{"on-change":e.enterName},model:{value:e.item.name,callback:function(t){e.$set(e.item,"name",t)},expression:"item.name"}})],1),s("FormItem",{attrs:{label:"物品类别",prop:"type"}},[s("Select",{staticStyle:{display:"inline-block"},attrs:{"label-in-value":!0},on:{"on-change":e.changeType},model:{value:e.itemType,callback:function(t){e.itemType=t},expression:"itemType"}},e._l(e.$store.state.item.type,(function(t){return s("Option",{key:t,attrs:{value:e.$store.state.item.type.indexOf(t)+1}},[e._v(e._s(t)+" ")])})),1)],1),s("FormItem",{attrs:{label:"设置权限",prop:"privilege"}},[s("Slider",{staticStyle:{"margin-left":"10px"},attrs:{disabled:e.itemSlider,max:10,min:1,step:1,"show-input":""},model:{value:e.setPrivilege,callback:function(t){e.setPrivilege=t},expression:"setPrivilege"}})],1)],1),s("div",{attrs:{slot:"footer"},slot:"footer"},[s("Button",{on:{click:function(){return e.model=!1}}},[e._v("取消")]),s("Button",{attrs:{type:"primary"},on:{click:function(t){return e.changeItem("item")}}},[e._v("确定")])],1)],1)},J=[],V={name:"changeItem",data(){const e=(e,t,s)=>{""===this.itemType?s(new Error("请选择物品类别")):s()};return{model:!1,itemSlider:!0,setPrivilege:1,itemType:"",item:{id:"",name:"",type:""},ruleItem:{id:[{required:!0,message:"请输入物品ID",trigger:"blur"}],name:[{required:!0,message:"请输入物品名称",trigger:"blur"}],type:[{required:!0,validator:e,trigger:"blur"}]}}},methods:{changeType(e){this.itemType=e.value},enterName(){this.itemSlider=!1},changeItem(e){this.$refs[e].validate(e=>{e&&Object(l["a"])({url:"/gm/insertItem",params:{id:this.item.id,name:this.item.name,type:this.item.type,privilege:this.setPrivilege}},this).then(e=>{0===e.data.resultCode?(this.$Message.success(e.data.rtnMessage),this.model=!1,this.$store.dispatch("getItem",this)):this.$Message.error(e.data.rtnMessage),this.$Spin.hide()}).catch(e=>{console.log(e),this.$Message.error("发生错误，请联系管理员")})})}}},X=V,K=Object(c["a"])(X,H,J,!1,null,"720c144b",null),Q=K.exports,W={name:"Admin",data(){return{disabled:!0,userSlider:!0,gmSlider:!0,setUserPrivilege:1,setGmPrivilege:1,itemInfo:"",userFn:"",gmFn:"",userFnList:[{value:-1,label:"请选择"},{value:"addPrivilege",label:"提升权限"},{value:"mail",label:"发送物品"},{value:"resetPassword",label:"修改密码"}],gmFnList:[{value:-1,label:"请选择"},{value:"gmMail",label:"发送物品"},{value:"gmInsertRegCode",label:"生成激活码"},{value:"gmDeleteRegCode",label:"删除激活码"},{value:"gmCloseAccount",label:"封禁用户"}],isAdmin:!0}},methods:{setUser(){Object(l["a"])({url:"/gm/updateFunction",params:{name:this.userFn,privilege:this.setUserPrivilege}},this).then(e=>{0===e.data.resultCode?(this.$Message.success(e.data.rtnMessage),this.$store.commit("updateFunction",{fun:this.userFn,privilege:this.setUserPrivilege})):this.$Message.error(e.data.rtnMessage),this.$Spin.hide()}).catch(e=>{console.log(e),this.$Message.error("发生错误，请联系管理员")})},setGm(){Object(l["a"])({url:"/gm/updateFunction",params:{name:this.gmFn,privilege:this.setGmPrivilege}},this).then(e=>{0===e.data.resultCode?(this.$Message.success(e.data.rtnMessage),this.$store.commit("updateFunction",{fun:this.gmFn,privilege:this.setGmPrivilege})):this.$Message.error(e.data.rtnMessage),this.$Spin.hide()}).catch(e=>{console.log(e),this.$Message.error("发生错误，请联系管理员")})},changeUserPrivilege(e){-1===e.value?this.userSlider=!0:this.userSlider=!1,this.setUserPrivilege=this.$store.state.functions[e.value]},changeGmPrivilege(e){-1===e.value?this.gmSlider=!0:this.gmSlider=!1,this.setGmPrivilege=this.$store.state.functions[e.value]},postBan(e){this.disabled=!1,this.itemInfo=e},deleteItem(){this.$Modal.confirm({title:"删除物品",content:"<p>确认删除物品"+this.itemInfo.name+"吗？</p>",onOk:()=>{Object(l["a"])({url:"/gm/deleteItem",params:{itemId:this.itemInfo.id}},this).then(e=>{0===e.data.resultCode?this.$store.dispatch("getItem",this):this.$Message.error(e.data.rtnMessage),this.$Spin.hide()}).catch(e=>{console.log(e),this.$Message.error("发生错误，请联系管理员")})},onCancel:()=>{}})},addItem(){this.$refs.itemBox.model=!0},uploadItem(e){0===e.resultCode?(this.$Message.success(e.rtnMessage),this.$store.dispatch("getItem",this)):this.$Message.error(e.rtnMessage),this.$Spin.hide()},exportItem(){let e="http://127.0.0.1/gm/export",t=new XMLHttpRequest;t.open("GET",e,!0),t.responseType="blob",t.onload=function(){if(200==this.status){let e=this.response,t=new FileReader;t.readAsDataURL(e),t.onload=function(e){let t=document.createElement("a");t.download="item.xls",t.href=e.target.result,document.body.append(t),t.click(),document.body.removeChild(t)}}},t.send()}},components:{ItemTable:_,CodeTable:A,ChangeItem:Q}},Y=W,Z=(s("6dc5"),Object(c["a"])(Y,z,D,!1,null,null,null)),ee=Z.exports,te=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("Modal",{attrs:{"class-name":"login-modal",title:e.title,closable:!1,"mask-closable":!1,"footer-hide":!0,width:"800"},model:{value:e.$store.state.login.loginBox,callback:function(t){e.$set(e.$store.state.login,"loginBox",t)},expression:"$store.state.login.loginBox"}},[s("Tabs",{attrs:{value:e.$store.state.login.tabValue,type:"card"}},[s("TabPane",{attrs:{name:"login",label:"登录"}},[s("Sign")],1),s("TabPane",{attrs:{name:"register",label:"注册"}},[s("Register")],1),s("TabPane",{attrs:{name:"reset",label:"修改密码"}},[s("Revise")],1)],1)],1)},se=[],re=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("Form",{ref:"formSign",attrs:{"label-position":"left",model:e.formSign,rules:e.ruleSign,"label-width":80}},[s("FormItem",{staticStyle:{"font-size":"12px"},attrs:{label:"用户名",prop:"username"}},[s("Input",{attrs:{placeholder:"请输入用户名...",type:"text"},model:{value:e.formSign.username,callback:function(t){e.$set(e.formSign,"username",t)},expression:"formSign.username"}})],1),s("FormItem",{attrs:{label:"密码",prop:"password"}},[s("Input",{attrs:{placeholder:"请输入密码...",type:"password"},model:{value:e.formSign.password,callback:function(t){e.$set(e.formSign,"password",t)},expression:"formSign.password"}})],1),s("Button",{staticStyle:{width:"100%"},attrs:{type:"success",long:""},on:{click:function(t){e.login("formSign").then(e.init)}}},[e._v("登录")]),e.$store.state.login.submit?s("Spin",{attrs:{fix:""}}):e._e()],1)},ae=[];var ie={name:"Sign",data(){return{formSign:{username:"",password:""},ruleSign:{username:[{required:!0,message:"用户名不能为空",trigger:"blur"},{min:6,message:"用户名至少6位",trigger:"blur"}],password:[{required:!0,message:"密码不能为空",trigger:"blur"},{min:6,message:"密码至少6位",trigger:"blur"}]}}},methods:{login(e){return new Promise((t,s)=>{this.$refs[e].validate(e=>{e&&Object(l["b"])({url:"/user/login",params:{username:this.formSign.username,password:this.formSign.password}},this).then(e=>{const s=e.data,r=s.data;if(0===s.resultCode){localStorage.setItem("loginStatus","true"),this.$store.commit("login"),this.$store.commit("hideLoginBox");for(let e in r)localStorage.setItem(e,r[e]);this.$store.commit("updateInfo",{username:localStorage.getItem("username"),roleName:localStorage.getItem("roleName"),privilege:localStorage.getItem("privilege")}),this.$store.commit("hideSubmit"),this.$Message.success(e.data.rtnMessage+"欢迎来到魔仙堡"),this.$store.dispatch("getItem",this),this.$store.dispatch("getCode",this)}else this.$store.commit("hideSubmit"),this.$Message.error(s.rtnMessage);t()}).catch(e=>{console.log(e),this.$Message.error("发生错误，请联系管理员"),s()})})})},init(){this.$store.dispatch("init",this).then(()=>{this.$store.state.user.privilege>=this.$store.state.login.min?this.$store.commit("changeGm",!0):this.$store.commit("changeGm",!1),this.$store.state.user.privilege>=10?this.$store.commit("changeAdmin",!0):this.$store.commit("changeAdmin",!1)})}}},oe=ie,le=(s("4994"),Object(c["a"])(oe,re,ae,!1,null,null,null)),ne=le.exports,me=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("Form",{ref:"formRegister",attrs:{"label-position":"left",model:e.formRegister,rules:e.ruleRegister,"label-width":80}},[s("FormItem",{attrs:{label:"账号",prop:"username"}},[s("Input",{attrs:{type:"text",placeholder:"请输入账号..."},model:{value:e.formRegister.username,callback:function(t){e.$set(e.formRegister,"username",t)},expression:"formRegister.username"}})],1),s("FormItem",{attrs:{label:"昵称",prop:"roleName"}},[s("Input",{attrs:{type:"text",placeholder:"请输入昵称..."},model:{value:e.formRegister.roleName,callback:function(t){e.$set(e.formRegister,"roleName",t)},expression:"formRegister.roleName"}})],1),s("FormItem",{attrs:{label:"密码",prop:"password"}},[s("Input",{attrs:{type:"password",placeholder:"请输入密码..."},model:{value:e.formRegister.password,callback:function(t){e.$set(e.formRegister,"password",t)},expression:"formRegister.password"}})],1),s("FormItem",{attrs:{label:"确认密码",prop:"passwordCheck"}},[s("Input",{attrs:{type:"password",placeholder:"请再次输入密码..."},model:{value:e.formRegister.passwordCheck,callback:function(t){e.$set(e.formRegister,"passwordCheck",t)},expression:"formRegister.passwordCheck"}})],1),s("div",{staticStyle:{width:"100%",display:"inline-block",position:"relative"}},[s("Button",{staticStyle:{width:"100%"},attrs:{type:"success",long:""},on:{click:function(t){return e.register("formRegister")}}},[e._v("注册")]),e.$store.state.submit?s("Spin",{attrs:{fix:""}}):e._e()],1)],1)},ce=[],de={name:"Register",data(){const e=(e,t,s)=>{""===t?s(new Error("请再次输入密码")):t!==this.formRegister.password?s(new Error("两次密码不一致")):s()};return{formRegister:{username:"",roleName:"",password:"",passwordCheck:""},ruleRegister:{username:[{required:!0,message:"账号不能为空",trigger:"blur"},{min:6,message:"账号至少6位",trigger:"blur"}],roleName:[{required:!0,message:"昵称不能为空",trigger:"blur"}],password:[{required:!0,message:"密码不能为空",trigger:"blur"},{min:6,message:"密码至少6位",trigger:"blur"}],passwordCheck:[{required:!0,validator:e,trigger:"blur"}]}}},methods:{register(e){this.$refs[e].validate(e=>{e&&Object(l["b"])({url:"/user/register",params:{username:this.formRegister.username,roleName:this.formRegister.roleName,password:this.formRegister.password}}).then(e=>{const t=e.data,s=t.data;if(0===t.resultCode){this.$store.commit("login"),this.$store.commit("hideLoginBox");for(let e in s)localStorage.setItem(e,s[e]);this.$store.commit("updateInfo",{username:localStorage.getItem("username"),roleName:localStorage.getItem("roleName"),privilege:localStorage.getItem("privilege")})}else this.$store.commit("hideSubmit"),this.$Message.error(t.rtnMessage)}).catch(e=>{console.log(e),this.$Message.error("发生错误，请联系管理员")})})}}},ge=de,ue=Object(c["a"])(ge,me,ce,!1,null,"8fbf4c80",null),pe=ue.exports,he=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("Form",{ref:"formRevise",attrs:{"label-position":"left",model:e.formRevise,rules:e.ruleRevise,"label-width":80}},[s("FormItem",{attrs:{label:"原密码",prop:"oldPwd"}},[s("Input",{attrs:{placeholder:"请输入原密码...",type:"password"},model:{value:e.formRevise.oldPwd,callback:function(t){e.$set(e.formRevise,"oldPwd",t)},expression:"formRevise.oldPwd"}})],1),s("FormItem",{attrs:{label:"新密码",prop:"password"}},[s("Input",{attrs:{placeholder:"请输入新密码...",type:"password"},model:{value:e.formRevise.password,callback:function(t){e.$set(e.formRevise,"password",t)},expression:"formRevise.password"}})],1),s("FormItem",{attrs:{label:"确认密码",prop:"passwordCheck"}},[s("Input",{attrs:{placeholder:"请再次输入密码...",type:"password"},model:{value:e.formRevise.passwordCheck,callback:function(t){e.$set(e.formRevise,"passwordCheck",t)},expression:"formRevise.passwordCheck"}})],1),s("div",{staticStyle:{width:"100%",display:"inline-block",position:"relative"}},[s("Button",{staticStyle:{width:"100%"},attrs:{type:"success",long:""},on:{click:function(t){return e.revise("formRevise")}}},[e._v("修改密码")]),e.$store.state.submit?s("Spin",{attrs:{fix:""}}):e._e()],1)],1)},ve=[],fe={name:"Revise",data(){const e=(e,t,s)=>{""===t?s(new Error("请再次输入密码")):t!==this.formRevise.password?s(new Error("两次密码不一致")):s()};return{formRevise:{username:"",oldPwd:"",password:"",passwordCheck:""},ruleRevise:{oldPwd:[{required:!0,message:"原密码不能为空",trigger:"blur"},{min:6,message:"密码至少6位",trigger:"blur"}],password:[{required:!0,message:"密码不能为空",trigger:"blur"},{min:6,message:"密码至少6位",trigger:"blur"}],passwordCheck:[{required:!0,validator:e,trigger:"blur"}]}}},methods:{revise(e){this.$refs[e].validate(e=>{e&&Object(l["b"])({url:"/user/resetPassword",params:{password:this.formRevise.oldPwd,newPassword:this.formRevise.password}}).then(e=>{const t=e.data.data;if(0===e.data.resultCode){this.$store.commit("hideLoginBox");for(let e in t)localStorage.setItem(e,t[e])}else this.$Message.error(e.data.rtnMessage);this.$store.commit("hideSubmit")}).catch(e=>{console.log(e),this.$Message.error("发生错误，请联系管理员")})})}}},be=fe,$e=Object(c["a"])(be,he,ve,!1,null,"124a4092",null),Ie=$e.exports,ye={name:"Login",data(){return{title:"欢迎使用本系统，请先登录或注册"}},mounted(){},components:{Revise:Ie,Sign:ne,Register:pe}},Se=ye,we=(s("4fde"),Object(c["a"])(Se,te,se,!1,null,null,null)),xe=we.exports,Ce={name:"Home",components:{Center:g,Resource:R,Manger:q,Admin:ee,Login:xe},mounted(){localStorage.getItem("loginStatus")?(this.$store.commit("hideLoginBox"),this.$store.commit("login"),this.$store.commit("updateInfo",{username:localStorage.getItem("username"),roleName:localStorage.getItem("roleName"),privilege:localStorage.getItem("privilege")}),this.$store.dispatch("init",this).then(()=>{console.log(this.$store.state.user.privilege),console.log(this.$store.state.login.min),this.$store.state.user.privilege>=this.$store.state.login.min?this.$store.commit("changeGm",!0):this.$store.commit("changeGm",!1),this.$store.state.user.privilege>=10?this.$store.commit("changeAdmin",!0):this.$store.commit("changeAdmin",!1)})):this.$store.commit("showLoginBox")}},_e=Ce,Me=(s("cccb"),Object(c["a"])(_e,r,a,!1,null,null,null));t["default"]=Me.exports},cccb:function(e,t,s){"use strict";var r=s("5ced"),a=s.n(r);a.a}}]);
//# sourceMappingURL=chunk-1ecf3864.a8a8f980.js.map